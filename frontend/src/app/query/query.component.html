<section id="searchSection">
  <form name="searchform" (ngSubmit)="submitSearchForm()">
    <div>
      <div class="query-field" [style.fontSize.rem]="1.12">
        <mat-form-field appearance="fill" [color]=colorControl.value>
          <mat-label>Enter a search term</mat-label>
          <input matInput id="queryStringInput"
                 type="text"
                 name="qp.queryText"
                 autocomplete="off"
                 [(ngModel)]="qp.queryText">
          <button mat-icon-button matSuffix>
            <mat-icon matSuffix class="fal fa-search"></mat-icon>
          </button>
        </mat-form-field>
        <div class="query-padding-left">
        <query-flags [inputTerm]="qp.queryText"
                     (hasValidQueryFlags)="isShownQueryFlagsContainer($event)"></query-flags>
        </div>
      </div>
      <div class="dropdown-menus-bar" *ngIf="isFiltersDisplayed()">
        <button mat-button type="button" id="typeMenu"
                [matMenuTriggerFor]="typesMenu" #typesTrigger="matMenuTrigger">Types {{countSelectedDropdownItems(qp.types)}}
          <span *ngIf="typesTrigger.menuOpen" class="fal fa-chevron-up"></span>
          <span *ngIf="!typesTrigger.menuOpen" class="fal fa-chevron-down"></span>
        </button>
        <mat-menu #typesMenu="matMenu" yPosition="below">
          <types-panel [(queryParameters)]="qp"></types-panel>
        </mat-menu>
        <button mat-button type="button" id="hierarchyFlagsMenu"
                [matMenuTriggerFor]="hierarchyFlagsMenu" #hierarchyTrigger="matMenuTrigger">Hierarchy flags {{countSelectedDropdownHierarchyFlags()}}
          <span *ngIf="hierarchyTrigger.menuOpen" class="fal fa-chevron-up"></span>
          <span *ngIf="!hierarchyTrigger.menuOpen" class="fal fa-chevron-down"></span>
        </button>
        <mat-menu #hierarchyFlagsMenu="matMenu" yPosition="below" >
          <hierarchy-flags [(queryParameters)]="qp"></hierarchy-flags>
        </mat-menu>
        <button mat-button type="button" id="inverseLookupMenu"
                [matMenuTriggerFor]="inverseLookupMenu" #inverseLookupTrigger="matMenuTrigger">Inverse lookup {{countSelectedDropdownItems(qp.inverse)}}
          <span *ngIf="inverseLookupTrigger.menuOpen" class="fal fa-chevron-up"></span>
          <span *ngIf="!inverseLookupTrigger.menuOpen" class="fal fa-chevron-down"></span>
        </button>
        <mat-menu #inverseLookupMenu="matMenu" yPosition="below">
          <inverse-lookup-panel [(queryParameters)]="qp"></inverse-lookup-panel>
        </mat-menu>
        <button mat-button type="button" id="advanceFilterMenu"
                [matMenuTriggerFor]="advanceFilterMenu" #advanceFilterTrigger="matMenuTrigger">Advance
          filter {{countSelectedDropdownAdvanceFilter()}}
          <span *ngIf="advanceFilterTrigger.menuOpen" class="fal fa-chevron-up"></span>
          <span *ngIf="!advanceFilterTrigger.menuOpen" class="fal fa-chevron-down"></span>
        </button>
        <mat-menu #advanceFilterMenu="matMenu" yPosition="below">
          <advance-filter-panel [(queryParameters)]="qp"></advance-filter-panel>
        </mat-menu>
      </div>
    </div>
    <div class="query-padding-left">
      <submitting-agreement></submitting-agreement>
    </div>
    <br />
  </form>
</section>

<div class="query-padding">
<org-drop-down></org-drop-down>
<certificate-banner></certificate-banner>
<section>
    <a id="anchorTop"></a>
    <div class="visualClear"></div>
    <div class="documentActions"></div>
    <h1 class="documentFirstHeading">RIPE Database Query</h1>
    <div class="documentByLine"><span class="byline"></span></div>
    <div class="documentDescription"></div>
</section>
<section id="resultsSection">
    <div *ngIf="results?.length > 0">
        <div class="float-end resultlinks" *ngIf="link.perma">
            <a href="{{ link.perma }}">
                <i class="fal fa-link" title="Permanent link to the results for this query."></i>
                PERMA
            </a>&nbsp;
            <a href="{{ link.xml }}"
               title="XML format of the results for this query." target="_blank">
                <i class="fal fa-file-code"></i>
                XML
            </a>&nbsp;
            <a href="{{ link.json }}"
               title="JSON format of the results for this query." target="_blank">
                <i class="fal fa-file-alt"></i>
                JSON
            </a>
        </div>
        <h2>Search results</h2>
        <p [innerHTML]="'msg.searchResults.text' | label"></p>
        <div class="clearfix" *ngFor="let whoisObject of results">
            <div class="resultpane">
                <lookup [whoisObject]="whoisObject"></lookup>
            </div>
        </div>
        <p *ngIf="showScroller" scroller (scrolled)="lastResultOnScreen()">
            <loading-indicator></loading-indicator>
        </p>
    </div>
</section>
<section id="templateResultsSection" *ngIf="showTemplatePanel">
    <h2>Search results</h2>
    <p [innerHTML]="'msg.searchResults.text' | label"></p>
    <lookup-template [query]="queriedTemplateObject"></lookup-template>
</section>
<section id="informationSection" *ngIf="showsDocsLink">
  <div class="row">
    <div class="col-sm-6">
      <div class="border padding margin-bottom">
        <p style="font-weight:600;">Querying the RIPE Database </p>
          You can query the RIPE Database via the web interface, the RESTful API or a command line tool. Learn more about each option by clicking the link below.
        <p>&nbsp;</p>
        <a href="https://www.ripe.net/manage-ips-and-asns/db/support/documentation" target="_blank" class="link-color">Read documentation
          <i class="fal fa-external-link"></i>
        </a>
      </div>
    </div>
    <div class="col-sm-6">
      <div class="border padding margin-bottom">
        <p style="font-weight:600;">RESTful API</p>
        The RESTful API can only process one object at a time. If you want to process several objects simultaneously, you need to write a script on the client side to handle the list of objects and feed them.

        <p>&nbsp;</p>
        <a href="https://github.com/RIPE-NCC/whois/wiki/WHOIS-REST-API" target="_blank" class="link-color">Read more about RESTful API
          <i class="fal fa-external-link"></i>
        </a>
      </div>
    </div>
  </div>
</section>
<section id="databaseSwitchSection" *ngIf="showsDocsLink">
  <div class="row">
    <div class="col-sm-12 align-self-start">
      <div class="border padding margin-bottom">
        <p style="font-weight:600;">{{properties.SOURCE  === "RIPE" ? "Test" : "RIPE"}} Database</p>
        <div *ngIf="properties.SOURCE  === 'RIPE'; else inTestEnv">
          You can use this environment to learn and experiment with the RIPE Database. It uses a TEST source. Important: All changes are reverted every day at night.
        </div>
        <ng-template #inTestEnv>
          TEST environment is to learn and experiment with RIPE Database and all changes are reverted in the night. Switch to RIPE Database for live action.
        </ng-template>
        <a [href]="properties.QUERY_PAGE_LINK_TO_OTHER_DB" target="_blank" class="link-color">Take me to {{properties.SOURCE  === "RIPE" ? "Test" : "RIPE"}} Database
          <i class="fal fa-external-link"></i>
        </a>
      </div>
    </div>
  </div>
</section>
<whois-version [version]="whoisVersion"></whois-version>
</div>
