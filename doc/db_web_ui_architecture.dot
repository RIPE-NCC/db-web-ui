digraph G {
   
   rankdir=LR;
        
   subgraph clusterbrowser {
        label = "Browser";

   		OldAppInBrowser;
   		NewAppInBrowser;
   }

   subgraph clusterapacheproxy {
        label = "ApacheProxy";
        ProxyOldAppRules;
        ProxyNewAppRules;
   }

   subgraph clusteroldapp {
   	    label = "'DbWebWar' on http://apps.db.ripe.net/*";
		OldApp [label="DbWebWar (JSF)"];
   }

   subgraph clusternewapp {
   	    label = "'db-web-ui' on http://apps.db.ripe.net/db-web-ui/*";
   		NewAppStatics [label="DbWebUi (Statics)"];;
   		NewAppRest [label="DbWebUi (Web-service)",color="blue"];;
   }

   subgraph clusterbackends {
   		label = "Backends";
		Whois;
   		WhoisInternal;
   }

    OldAppInBrowser -> ProxyOldAppRules;
    ProxyOldAppRules -> OldApp;
    OldApp -> Whois;
    OldApp -> WhoisInternal;

	NewAppInBrowser -> ProxyNewAppRules [label="html,css,js"];
	NewAppInBrowser -> ProxyNewAppRules [label="REST"];
	ProxyNewAppRules -> NewAppStatics [label="html,css,js"];
	ProxyNewAppRules -> NewAppRest [label="REST",color="blue"];
	ProxyNewAppRules -> Whois [label="Skip in between alternative REST",color="red"]
	NewAppRest -> Whois [label="REST: rest.db.ripe.net",color="blue"];


}